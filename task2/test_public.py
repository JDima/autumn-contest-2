from typing import List

import pytest

from .task import task2


class Case:
    def __init__(self, name: str,
                 vert_count: int,
                 g: List[List[int]],
                 to_del: List[int],
                 answer: List[int]):
        self._name = name
        self.vert_count = vert_count
        self.g = g
        self.to_del = to_del
        self.answer = answer

    def __str__(self) -> str:
        return 'task2_test_{}'.format(self._name)


TEST_CASES = [
    Case(
        name='base1',
        vert_count=1,
        g=[[0]],
        to_del=[1],
        answer=[0]
    ),
    Case(
        name='base2',
        vert_count=2,
        g=[[0, 5], [4, 0]],
        to_del=[1, 2],
        answer=[9, 0]
    ),
    Case(
        name='base3',
        vert_count=4,
        g=[[0, 3, 1, 1],
           [6, 0, 400, 1],
           [2, 4, 0, 1],
           [1, 1, 1, 0]],
        to_del=[4, 1, 2, 3],
        answer=[17, 23, 404, 0]
    ),
    Case(
        name='base4',
        vert_count=4,
        g=[[0, 57148, 51001, 13357],
           [71125, 0, 98369, 67226],
           [49388, 90852, 0, 66291],
           [39573, 38165, 97007, 0]],
        to_del=[2, 3, 1, 4],
        answer=[723897, 306638, 52930, 0]
    ),
    Case(
        name='base5',
        vert_count=5,
        g=[[0, 27799, 15529, 16434, 44291],
           [47134, 0, 90227, 26873, 52252],
           [41605, 21269, 0, 9135, 55784],
           [70744, 17563, 79061, 0, 73981],
           [70529, 35681, 91073, 52031, 0]],
        to_del=[5, 2, 3, 1, 4],
        answer=[896203, 429762, 232508, 87178, 0]
    ),
    Case(
        name='base6',
        vert_count=6,
        g=[[0, 72137, 71041, 29217, 96749, 46417],
           [40199, 0, 55907, 57677, 68590, 78796],
           [83463, 50721, 0, 30963, 31779, 28646],
           [94529, 47831, 98222, 0, 61665, 73941],
           [24397, 66286, 2971, 81613, 0, 52501],
           [26285, 3381, 51438, 45360, 20160, 0]],
        to_del=[6, 3, 2, 4, 5, 1],
        answer=[1321441, 1030477, 698557, 345837, 121146, 0]
    ),
    Case(
        name='base7',
        vert_count=7,
        g=[[0, 34385, 31901, 51111, 10191, 14089, 95685],
           [11396, 0, 8701, 33277, 1481, 517, 46253],
           [51313, 2255, 0, 5948, 66085, 37201, 65310],
           [21105, 60985, 10748, 0, 89271, 42883, 77345],
           [34686, 29401, 73565, 47795, 0, 13793, 66997],
           [70279, 49576, 62900, 40002, 70943, 0, 89601],
           [65045, 1681, 28239, 12023, 40414, 89585, 0]],
        to_del=[3, 5, 7, 6, 1, 2, 4],
        answer=[1108867, 1016339, 729930, 407114, 206764, 94262, 0]
    ),
    Case(
        name='base8',
        vert_count=8,
        g=[[0, 74961, 47889, 4733, 72876, 21399, 63105, 48239],
           [15623, 0, 9680, 89133, 57989, 63401, 26001, 29608],
           [42369, 82390, 0, 32866, 46171, 11871, 67489, 54070],
           [23425, 80027, 18270, 0, 28105, 42657, 40876, 29267],
           [78793, 18701, 7655, 94798, 0, 88885, 71424, 86914],
           [44835, 76636, 11553, 46031, 13617, 0, 16971, 51915],
           [33037, 53719, 43116, 52806, 56897, 71241, 0, 11629],
           [2119, 62373, 93265, 69513, 5770, 90751, 36619, 0]],
        to_del=[3, 7, 6, 5, 8, 1, 2, 4],
        answer=[1450303, 1188349, 900316, 531281, 383344, 219125, 169160, 0]
    ),
    Case(
        name='base9',
        vert_count=9,
        g=[[0, 85236, 27579, 82251, 69479, 24737, 87917, 15149, 52311],
           [59640, 0, 74687, 34711, 3685, 30121, 4961, 7552, 83399],
           [33376, 68733, 0, 81357, 18042, 74297, 15466, 29476, 5865],
           [7493, 5601, 3321, 0, 20263, 55901, 45756, 55361, 87633],
           [26751, 17161, 76681, 40376, 0, 39745, 50717, 56887, 90055],
           [18885, 76353, 47089, 43601, 21561, 0, 60571, 33551, 53753],
           [74595, 877, 71853, 93156, 97499, 70876, 0, 22713, 63961],
           [67725, 25309, 56358, 92376, 40641, 35433, 39781, 0, 97482],
           [81818, 12561, 85961, 81445, 3941, 76799, 31701, 43725, 0]],
        to_del=[6, 2, 9, 3, 5, 7, 1, 4, 8],
        answer=[2106523, 1533575, 1645151, 1255230, 946667, 618567, 287636, 147737, 0]
    )
]


@pytest.mark.parametrize('case', TEST_CASES, ids=str)
def test_task2(case: Case) -> None:
    answer = task2(
        vert_count=case.vert_count,
        g=case.g,
        to_del=case.to_del
    )
    assert answer == case.answer
